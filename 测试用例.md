# 测试用例

实现输出见"演示视频.mp4".

**测试用例 1: 完整游戏流程 (胜利)**

- **初始状态:** `game_stats.txt` 为空或包含 (胜利:0, 失败:0)。
- **操作序列:** 启动游戏。在 `START_SCREEN` 点击“开始游戏”。在 `SELECT_ZOMBIES` 点击“1个墓碑”按钮。在 `PLACE_BASE` 点击有效区域放置基地。在 `PLAYING` 状态，通过放置向日葵和豌豆射手，自动消灭所有5波僵尸，期间若进入 `UPGRADE_CHOICE` 则任选强化。当所有5波僵尸被成功防御后，在 `GAME_VICTORY` 点击屏幕。
- **预期效果:** 游戏从`START_SCREEN`依次转换状态至`SELECT_ZOMBIES`，然后`PLACE_BASE`，再到`PLAYING` (初始`currentRound=1`)。阳光因放置植物而减少。若进入`UPGRADE_CHOICE`，强化生效且`currentRound`增加。最终状态变为 `GAME_VICTORY`，`games_won` 增加1并保存统计数据。游戏退出，`game_stats.txt` 更新。

------

**测试用例 2: 游戏流程 (失败 - 基地被摧毁)**

- **初始状态:** `game_stats.txt` 为空或包含 (胜利:X, 失败:Y)。
- **操作序列:** 启动游戏。在 `START_SCREEN` 点击“开始游戏”。在 `SELECT_ZOMBIES` 点击“3个墓碑”按钮。在 `PLACE_BASE` 点击有效区域放置基地。在 `PLAYING` 不放置任何植物，等待僵尸摧毁基地。在 `GAME_OVER` 点击屏幕。
- **预期效果:** 游戏加载并读取统计数据。状态按序转换为`SELECT_ZOMBIES` (`selectedZombieCount=3`)，`PLACE_BASE`，然后 `PLAYING`。基地HP降至0，状态变为 `GAME_OVER`。`games_lost` 增加1并保存统计数据。游戏退出，`game_stats.txt` 更新。

------

**测试用例 3: 暂停与恢复/退出**

- **初始状态:** 任意，能进入`PLAYING`状态。
- **操作序列:** 启动游戏并进入 `PLAYING` 状态。在 `PLAYING` 按 `ESC` 键。在 `PAUSED` 点击屏幕。在 `PLAYING` 再次按 `ESC` 键。在 `PAUSED` 再次按 `ESC` 键。
- **预期效果:** 首次按 `ESC`，状态变为 `PAUSED`，游戏逻辑暂停。点击屏幕，状态恢复为 `PLAYING`，逻辑继续。再次按 `ESC`，状态变为 `PAUSED`。最后再按 `ESC`，调用 `cleanupPreviousGameSession`，状态变为 `START_SCREEN`。胜败统计不变。

------

**测试用例 4: 退出游戏操作**

- **初始状态:** 任意。
- **操作序列:** 启动游戏。在 `START_SCREEN` 点击“退出游戏”按钮。
- **预期效果:** 游戏加载后，`running` 变为 `false`，程序退出。`game_stats.txt` 内容不应因此操作而改变。

------

**测试用例 5: 放置基地位置无效**

- **初始状态:** 任意。
- **操作序列:** 启动游戏。在 `START_SCREEN` 点击“开始游戏”。在 `SELECT_ZOMBIES` 点击任意墓碑数量按钮。在 `PLACE_BASE`，首先点击非常靠近屏幕边缘的位置，然后（若有墓碑）点击与墓碑重叠的位置，最后点击一个有效位置。
- **预期效果:** 游戏进入`PLACE_BASE`状态。前两次无效点击，基地不会被放置，状态保持在`PLACE_BASE`。有效点击后，基地被放置，状态变为 `PLAYING`。

------

**测试用例 6: 植物选择与放置 (不同植物类型)**

- **初始状态:** 进入 `PLAYING` 状态，有充足阳光 (例如，阳光设置为500)。
- **操作序列:** 依次按住数字键1至5并点击地图放置对应植物（向日葵、豌豆射手、坚果墙、高坚果、双发射手）。然后不按任何数字键，点击地图。
- **预期效果:** 每种植物成功放置后，阳光相应减少（向日葵-50，豌豆射手-100，坚果墙-50，高坚果-125，双发射手-200）。不选择植物时点击地图无放置行为 (`selected_plant` 为 0)。

------

**测试用例 7: 阳光不足无法放置植物**

- **初始状态:** 进入 `PLAYING` 状态，阳光设置为0。
- **操作序列:** 按住 `1` 键 (选择向日葵，花费50)，点击地图。
- **预期效果:** 由于阳光不足，向日葵不会被创建，植物容器大小及阳光数量均不变。

------

**测试用例 8: 强化选择**

- **初始状态:** 完成一波僵尸，进入 `UPGRADE_CHOICE` 状态。确保场上至少有符合强化类型的植物和基地。
- **操作序列:** 分别测试点击“强化攻击”、“强化防御”、“强化基地”按钮（可能需要重置游戏状态以多次进入`UPGRADE_CHOICE`）。
- **预期效果:** 点击“强化攻击”后，对应攻击植物的`attack_power`增加。点击“强化防御”后，对应防御植物的`max_hp`和`hp`增加。点击“强化基地”后，基地的`max_hp`和`hp`增加。每次选择后，`currentRound`增加，游戏进入下一回合准备阶段，状态变为`PLAYING`并开始休息期。